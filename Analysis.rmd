---
title: "Case Study 0"
author: Austin Kao
date: 1/31/2021
output: pdf_document
---

```{r, echo = FALSE, message = FALSE, warning=FALSE}
# Specify all libraries needed
library(tidyverse)
```

# Introduction

The New York City police department has a Stop-Question-Frisk (SQF) policy where individuals can be stopped by police to be questioned and, in some cases, frisked based on the reasonable suspicion that the individual will commit a crime or is committing a crime. However, opponents of the policy protest that black and Hispanic residents are stopped by police at a significantly higher rate than white and Asian residents, making the practice unconstitutional. Now that a class-action lawsuit has led the NYPD to require justification for any SQF event, we seek to examine the impact of race in why police choose to stop residents over suspected violent crimes. We define violent crime to be any crime that involves force or the threat of force, which includes things like murder, robbery, and assault.

The data used for this case study comes directly from the NYPD Stop, Question, and Frisk database from the years of 2017 to 2019. We also use NYC police precinct data adapted from data compiled by John Keefe, an editor for the New York Times.

Because we are primarily concerned with the race of the suspects at SQF events, we filtered out 427 observations where the race was listed as null or male. Also, to examine SQF events across the years between 2017 and 2019.

```{r, echo = FALSE}
# Load in all data being used, rename certain fields
data17 = read.csv("sqf-2017.csv")
data18 = read.csv("sqf-2018.csv")
data19 = read.csv("sqf-2019.csv")
data18 <- data18 %>% rename(STOP_FRISK_TIME = Stop.Frisk.Time)
data19 <- data19 %>% rename(STOP_FRISK_ID = STOP_ID_ANONY)
```

```{r, echo = FALSE}
# Create a combined data set
combined_1718 <- rbind(data17, data18)
combined_1718$SUPERVISING_ACTION_CORRESPONDING_ACTIVITY_LOG_ENTRY_REVIEWED <- NULL
combined_1718$STOP_LOCATION_PREMISES_NAME <- NULL
data19$ASK_FOR_CONSENT_FLG <- NULL
data19$CONSENT_GIVEN_FLG <- NULL
combined_1719 <- rbind(combined_1718, data19)
```

Because we are examining the justification police officers give in conducting an SQF event, we want to consider any potential details officers will have access to or will have considered before commencing a stop, which are details like height, height, the presence of a weapon, body build type, age, and sex. We will also consider race as a factor and compare its influence against these other factors to establish the amount of racial disparity.

# Methodology

```{r, echo = FALSE}
# Filter out missing race data, adjust data in certain columns
filtered_1719 <- combined_1719 %>%
  filter(!SUSPECT_RACE_DESCRIPTION == "(null)" & !SUSPECT_RACE_DESCRIPTION == "MALE")
filtered_1719 <- filtered_1719 %>%
  filter(!SUSPECT_HEIGHT == "(null)" & !SUSPECT_HEIGHT == "#NULL!")
filtered_1719$SUSPECT_HEIGHT <- as.numeric(filtered_1719$SUSPECT_HEIGHT)
filtered_1719 <- filtered_1719 %>%
  filter(!SUSPECT_HEIGHT == 60.11)
filtered_1719 <- filtered_1719 %>%
  mutate(RACE = if_else(SUSPECT_RACE_DESCRIPTION == "AMERICAN INDIAN/ALASKAN NATIVE"
                        | SUSPECT_RACE_DESCRIPTION == "AMERICAN INDIAN/ALASKAN N", "AMER IND", SUSPECT_RACE_DESCRIPTION))
filtered_1719 <- filtered_1719 %>%
  mutate(RACE = if_else(RACE == "ASIAN / PACIFIC ISLANDER", "ASIAN/PAC.ISL", RACE))
filtered_1719 <- filtered_1719 %>%
  mutate(RACE = if_else(RACE == "WHITE HISPANIC", "W. HISP.", RACE))
filtered_1719 <- filtered_1719 %>%
  mutate(RACE = if_else(RACE == "BLACK HISPANIC", "B. HISP.", RACE))
filtered_1719 <- filtered_1719 %>%
  mutate(SUSPECTED_VIOLENCE = if_else(SUSPECTED_CRIME_DESCRIPTION == "ROBBERY" | SUSPECTED_CRIME_DESCRIPTION == "ASSAULT" | SUSPECTED_CRIME_DESCRIPTION == "RAPE" | SUSPECTED_CRIME_DESCRIPTION == "MURDER" | SUSPECTED_CRIME_DESCRIPTION == "TERRORISM" | SUSPECTED_CRIME_DESCRIPTION == "FORCIBLE TOUCHING" | SUSPECTED_CRIME_DESCRIPTION == "RECKLESS ENDANGERMENT" | SUSPECTED_CRIME_DESCRIPTION == "MENACING", 1, 0))
```

To classify a crime as violent, we created the "SUSPECTED_VIOLENCE" column, which has a value of 1 if the suspected crime is violent in nature, and 0 if the suspected crime is nonviolent. We based the "SUSPECTED_VIOLENCE" column on the information given for "SUSPECTED_CRIME_DESCRIPTION". The crimes we decided were violent are assault, menacing, forcible touching, murder, rape, terrorism, reckless endangerment, and robbery.

Because of missing data, some more observations were filtered from the data. There was also a suspect recorded as being 60.11 feet tall. This data point was also removed since it is unclear if the officer was using inches or added an extra zero.

We also removed an additional 1749 observations due to missing or impossible height and weight data. There was a suspect recorded as being 60.11 feet tall. This data point was also removed since it is unclear if the officer was using inches or added an extra zero. Some suspects had a recorded weight of 0, while one suspect had a weight of 1, which are both impossible, so these data points were also removed.

```{r}
ggplot(data = filtered_1719, aes_string(x = "SUSPECTED_VIOLENCE", y = "SUSPECT_HEIGHT")) +
  geom_boxplot() +
  labs(title = "Effect of Height on Suspected Violent Crime")
```


# Results

Based off the predictor variables we chose, we generated a model for the log odds that a suspect will be stopped by the police for a violent crime.

```{r}
violence_model <- glm(SUSPECTED_VIOLENCE ~ RACE + FRISKED_FLAG
                      + SEARCHED_FLAG, data = filtered_1719)
tidy(violence_model)
```

# Discussion



# Appendix

Bibliography
